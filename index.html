<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏∞‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå - ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ò‡∏£‡∏£‡∏°‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡∏û‡∏£‡∏∞‡πÑ‡∏ï‡∏£‡∏õ‡∏¥‡∏é‡∏Å</title>
  <meta name="description" content="‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ü‡∏±‡∏á‡∏ò‡∏£‡∏£‡∏°‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå ‡∏£‡∏ß‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ò‡∏£‡∏£‡∏°‡∏∞‡πÅ‡∏ö‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ü‡∏±‡∏á‡πÑ‡∏î‡πâ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏†‡∏≤‡∏ß‡∏ô‡∏≤ ‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏™‡∏ô‡πÉ‡∏à‡πÉ‡∏ô‡∏Ñ‡∏≥‡∏™‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏û‡∏£‡∏∞‡∏û‡∏∏‡∏ó‡∏ò‡πÄ‡∏à‡πâ‡∏≤">
  <meta name="keywords" content="‡∏ò‡∏£‡∏£‡∏°‡∏∞, ‡∏ü‡∏±‡∏á‡∏ò‡∏£‡∏£‡∏°‡∏∞, dhamma radio, ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ò‡∏£‡∏£‡∏°‡∏∞, ‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏∞, dhammasutta">
  <meta name="author" content="Dhamma-Sutta.com">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#fffaf0">
  <link rel="icon" href="images/icon.png">
  <style>
    body {
      font-family: "TH Sarabun New", "Sarabun", Tahoma, sans-serif;
      background: #fffaf0;
      color: #5a3e1b;
      padding: 20px;
      line-height: 1.6;
      /* ‡πÄ‡∏û‡∏¥‡πà‡∏° padding-bottom ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏á‡πÇ‡∏î‡∏¢ fixed player */
      padding-bottom: 150px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ç‡∏≠‡∏á fixed player */
    }
    .container {
      max-width: 700px;
      margin: auto;
      background: #fffef7;
      padding: 25px;
      border: 1px solid #d2b48c;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }
    h1, h2 {
      text-align: center;
      color: #8B0000;
    }
    .search-input {
      font-size: 18px;
      width: 50%;
      padding: 10px 14px;
      border-radius: 24px;
      border: 1px solid #4285F4;
      background-color: #f0f7ff;
      margin: 0 0 15px;
      display: block;
      color: #333;
    }
    .playlist-select {
      font-size: 18px;
      width: 100%;
      padding: 8px;
      border-radius: 8px;
      border: 1px solid #c9a77d;
      margin-bottom: 15px;
    }
    .stat-info {
      text-align: center;
      font-size: 14px;
      color: #888;
      margin-bottom: 20px;
    }
    .history-box {
      font-size: 16px;
      color: #444;
      background: #f5f3eb;
      border: 1px dashed #bbb;
      border-radius: 10px;
      padding: 15px;
      margin-top: 10px;
      margin-bottom: 20px; /* ‡πÄ‡∏û‡∏¥‡πà‡∏° margin-bottom ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ track */
    }
    .track-list {
      list-style: none;
      padding: 0;
      margin-top: 20px;
    }
    .track-item {
      margin: 8px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .track-button {
      flex: 1;
      padding: 10px;
      background: #fdf6e3;
      border: 1px solid #d5b48c;
      border-radius: 8px;
      text-align: left;
      font-size: 18px;
      color: #5a3e1b;
      cursor: pointer;
      margin-right: 10px;
    }
    .track-button:hover {
      background: #f7eacc;
    }
    .share-button {
      font-size: 16px;
      padding: 6px 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      background: #f5f5f5;
      cursor: pointer;
    }
    /* ‡∏•‡∏ö audio style ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏à‡∏∞‡∏¢‡πâ‡∏≤‡∏¢‡πÑ‡∏õ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ô fixed-bottom-player-wrapper */
    .footer-link {
      text-align: center;
      font-size: 14px;
      color: #999;
      margin-top: 40px;
    }
    .footer-link a {
      color: #999;
      text-decoration: none;
    }
    .footer-link a:hover {
      text-decoration: underline;
    }
    /* ‡∏•‡∏ö .resume-button style ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏à‡∏∞‡∏¢‡πâ‡∏≤‡∏¢‡πÑ‡∏õ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ô fixed-bottom-player-wrapper */

    /* --- START: CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Fixed Bottom Player --- */
    .fixed-bottom-player-wrapper {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #fffef7; /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Å‡∏±‡∏ö container */
      padding: 15px 20px;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
      z-index: 1000; /* ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏≠‡∏∑‡πà‡∏ô */
      display: flex;
      flex-direction: column;
      align-items: center;
      box-sizing: border-box;
    }

    .fixed-bottom-player-wrapper .resume-button {
      margin-bottom: 10px; /* ‡∏•‡∏î margin-bottom ‡πÄ‡∏î‡∏¥‡∏°‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
      padding: 8px 14px;
      border-radius: 6px;
      background: #fef2cc;
      border: 1px solid #e0c76f;
      font-size: 16px;
      cursor: pointer;
    }
    .fixed-bottom-player-wrapper .resume-button:hover {
      background: #fce7aa;
    }

    .fixed-bottom-player-wrapper audio {
      width: 100%;
      max-width: 700px; /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ audio player ‡πÑ‡∏°‡πà‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏ö‡∏ô‡∏à‡∏≠‡πÉ‡∏´‡∏ç‡πà */
      /* margin-top: 0; ‡πÄ‡∏≠‡∏≤ margin-top ‡∏Ç‡∏≠‡∏á audio ‡πÄ‡∏î‡∏¥‡∏°‡∏≠‡∏≠‡∏Å */
    }
    /* --- END: CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Fixed Bottom Player --- */

  </style>
</head>
<body>
  <div class="container">
    <h1></h1>

    <input type="text" id="searchInput" class="search-input" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≠‡∏ô..." />

    <select id="playlistSelect" class="playlist-select">
      <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∏‡∏î‡∏ò‡∏£‡∏£‡∏°‡∏∞...</option>
    </select>

    <div id="statInfo" class="stat-info">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£...</div>

    <div id="historyBox" class="history-box" style="display: none;"></div>

    <ul id="trackList" class="track-list"></ul>

    <div class="footer-link">
      <a href="https://www.dhamma-sutta.com" target="_blank">‡∏ò‡∏£‡∏£‡∏°‡∏™‡∏∏‡∏ï‡∏ï‡∏∞ Dhamma-Sutta.com</a>
    </div>
  </div> <div class="fixed-bottom-player-wrapper">
    <div> <button class="resume-button" onclick="resumeLastTrack()">‚ñ∂Ô∏è ‡πÄ‡∏•‡πà‡∏ô‡∏ï‡∏≠‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
    </div>

    <audio id="audioPlayer" controls>
      <source src="" type="audio/mpeg" />
      ‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á
    </audio>
  </div>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js');
      });
    }

    let playlists;
    let currentTracks = [];

    const audio = document.getElementById("audioPlayer");
    const trackList = document.getElementById("trackList");
    const playlistSelect = document.getElementById("playlistSelect");
    const searchInput = document.getElementById("searchInput");
    const statInfo = document.getElementById("statInfo");
    const historyBox = document.getElementById("historyBox");

    fetch("playlists.json")
      .then(response => response.json())
      .then(data => {
        playlists = data;
        let totalTracks = 0;
        Object.keys(playlists).forEach(name => {
          const option = document.createElement("option");
          option.value = name;
          option.textContent = name;
          playlistSelect.appendChild(option);
          totalTracks += playlists[name].length;
        });

        statInfo.textContent = `üî∏ ‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${totalTracks} ‡∏ï‡∏≠‡∏ô‡πÉ‡∏ô ${Object.keys(playlists).length} ‡∏ä‡∏∏‡∏î üôè`;

        const lastTrack = localStorage.getItem("lastTrackUrl");
        if (lastTrack) {
          // audio.src = lastTrack; // ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á preload ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
                                // ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á source ‡πÑ‡∏ß‡πâ‡πÄ‡∏â‡∏¢‡πÜ ‡∏Å‡πá‡πÉ‡∏™‡πà‡∏Ñ‡∏∑‡∏ô‡πÑ‡∏î‡πâ
        }

        showHistory();
      });

    playlistSelect.addEventListener("change", function () {
      const selected = this.value;
      trackList.innerHTML = "";
      currentTracks = playlists[selected] || [];
      showFilteredTracks(searchInput.value);
    });

    searchInput.addEventListener("input", () => {
      showFilteredTracks(searchInput.value);
    });

    function showFilteredTracks(keyword) {
      trackList.innerHTML = "";
      const filtered = currentTracks.filter(track =>
        track.title.toLowerCase().includes(keyword.toLowerCase())
      );
      filtered.forEach(track => {
        const li = document.createElement("li");
        li.className = "track-item";

        const btn = document.createElement("button");
        btn.className = "track-button";
        btn.textContent = `‚ñ∂Ô∏è ${track.title}`;
        btn.onclick = () => {
          audio.src = track.url;
          audio.play();
          localStorage.setItem("lastTrackUrl", track.url);
          saveHistory(track);
          showHistory();
        };

        const shareBtn = document.createElement("button");
        shareBtn.className = "share-button";
        shareBtn.textContent = "üîó ‡πÅ‡∏ä‡∏£‡πå";
        shareBtn.onclick = () => {
          navigator.clipboard.writeText(track.url);
          alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏•‡πâ‡∏ß: " + track.url);
        };

        li.appendChild(btn);
        li.appendChild(shareBtn);
        trackList.appendChild(li);
      });
    }

    function saveHistory(track) {
      let history = JSON.parse(localStorage.getItem("history")) || [];
      history = history.filter(t => t.url !== track.url);
      history.unshift({ title: track.title, url: track.url });
      if (history.length > 3) history.pop();
      localStorage.setItem("history", JSON.stringify(history));
    }

    function showHistory() {
      const history = JSON.parse(localStorage.getItem("history")) || [];
      if (history.length === 0) {
        historyBox.style.display = "none";
        return;
      }
      historyBox.style.display = "block";
      historyBox.innerHTML = "<strong>üïí ‡∏ü‡∏±‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:</strong><ul style='padding-left: 20px;'>" +
        history.map(item => `<li><a href="#" onclick="playFromHistory('${item.url}', '${item.title.replace(/'/g, "\\'")}')">${item.title}</a></li>`).join('') + // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏´‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡πà‡∏ô
        "</ul>";
    }

    function playFromHistory(url, title) {
        audio.src = url;
        audio.play();
        localStorage.setItem("lastTrackUrl", url);
        // ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô‡∏à‡∏≤‡∏Å history ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï history ‡∏î‡πâ‡∏ß‡∏¢ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å saveHistory ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
        // saveHistory({title: title, url: url}); // ‡πÅ‡∏ï‡πà‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏±‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
        showHistory(); // ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä history ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á
    }

    function resumeLastTrack() {
      const lastTrack = localStorage.getItem("lastTrackUrl");
      if (lastTrack) {
        audio.src = lastTrack;
        audio.play();
      } else {
        alert("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ü‡∏±‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î");
      }
    }
  </script>
</body>
</html>
